!function(exports,global){function hex_sha1(a){return binb2hex(core_sha1(str2binb(a),a.length*chrsz))}function b64_sha1(a){return binb2b64(core_sha1(str2binb(a),a.length*chrsz))}function str_sha1(a){return binb2str(core_sha1(str2binb(a),a.length*chrsz))}function hex_hmac_sha1(a,b){return binb2hex(core_hmac_sha1(a,b))}function b64_hmac_sha1(a,b){return binb2b64(core_hmac_sha1(a,b))}function str_hmac_sha1(a,b){return binb2str(core_hmac_sha1(a,b))}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc")}function core_sha1(a,b){a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b;for(var c=Array(80),d=1732584193,e=-271733879,f=-1732584194,g=271733878,h=-1009589776,i=0;i<a.length;i+=16){for(var j=d,k=e,l=f,m=g,n=h,o=0;80>o;o++){c[o]=16>o?a[i+o]:rol(c[o-3]^c[o-8]^c[o-14]^c[o-16],1);var p=safe_add(safe_add(rol(d,5),sha1_ft(o,e,f,g)),safe_add(safe_add(h,c[o]),sha1_kt(o)));h=g,g=f,f=rol(e,30),e=d,d=p}d=safe_add(d,j),e=safe_add(e,k),f=safe_add(f,l),g=safe_add(g,m),h=safe_add(h,n)}return[d,e,f,g,h]}function sha1_ft(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function sha1_kt(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function core_hmac_sha1(a,b){var c=str2binb(a);c.length>16&&(c=core_sha1(c,a.length*chrsz));for(var d=Array(16),e=Array(16),f=0;16>f;f++)d[f]=909522486^c[f],e[f]=1549556828^c[f];var g=core_sha1(d.concat(str2binb(b)),512+b.length*chrsz);return core_sha1(e.concat(g),672)}function safe_add(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function rol(a,b){return a<<b|a>>>32-b}function str2binb(a){for(var b=[],c=(1<<chrsz)-1,d=0;d<a.length*chrsz;d+=chrsz)b[d>>5]|=(a.charCodeAt(d/chrsz)&c)<<32-chrsz-d%32;return b}function binb2str(a){for(var b="",c=(1<<chrsz)-1,d=0;d<32*a.length;d+=chrsz)b+=String.fromCharCode(a[d>>5]>>>32-chrsz-d%32&c);return b}function binb2hex(a){for(var b=hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(15&a[d>>2]>>8*(3-d%4)+4)+b.charAt(15&a[d>>2]>>8*(3-d%4));return c}function binb2b64(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c="",d=0;d<4*a.length;d+=3)for(var e=(255&a[d>>2]>>8*(3-d%4))<<16|(255&a[d+1>>2]>>8*(3-(d+1)%4))<<8|255&a[d+2>>2]>>8*(3-(d+2)%4),f=0;4>f;f++)c+=8*d+6*f>32*a.length?b64pad:b.charAt(63&e>>6*(3-f));return c}global["true"]=exports;var enyo={};enyo.pathResolverFactory=function(){this.paths={}},enyo.pathResolverFactory.prototype={addPath:function(a,b){return this.paths[a]=b},addPaths:function(a){if(a)for(var b in a)this.addPath(b,a[b])},includeTrailingSlash:function(a){return a&&"/"!==a.slice(-1)?a+"/":a},rewritePattern:/\$([^\/\\]*)(\/)?/g,rewrite:function(a){var b,c=this.includeTrailingSlash,d=this.paths,e=function(a,e){return b=!0,c(d[e])||""},f=a;do b=!1,f=f.replace(this.rewritePattern,e);while(b);return f}},enyo.log=function(a){console.log(a)},enyo.path=new enyo.pathResolverFactory,enyo.platform={},enyo.json=JSON,enyo.warn=enyo.log,function(){enyo.global=this,enyo._getProp=function(a,b,c){for(var d,e=c||enyo.global,f=0;e&&(d=a[f]);f++)e="enyo"===d?enyo:d in e?e[d]:b?e[d]={}:void 0;return e},enyo.setObject=function(a,b,c){var d=a.split("."),e=d.pop(),f=enyo._getProp(d,!0,c);return f&&e?f[e]=b:void 0},enyo.getObject=function(a,b,c){return enyo._getProp(a.split("."),b,c)},enyo.irand=function(a){return Math.floor(Math.random()*a)},enyo.cap=function(a){return a.slice(0,1).toUpperCase()+a.slice(1)},enyo.uncap=function(a){return a.slice(0,1).toLowerCase()+a.slice(1)},enyo.format=function(a){var b=/\%./g,c=0,d=a,e=arguments,f=function(){return e[++c]};return d.replace(b,f)};var a=Object.prototype.toString;enyo.isString=function(b){return"[object String]"===a.call(b)},enyo.isFunction=function(b){return"[object Function]"===a.call(b)},enyo.isArray=Array.isArray||function(b){return"[object Array]"===a.call(b)},enyo.isTrue=function(a){return"false"!==a&&a!==!1&&0!==a&&null!==a&&void 0!==a},enyo.indexOf=function(a,b,c){if(b.indexOf)return b.indexOf(a,c);if(c&&(0>c&&(c=0),c>b.length))return-1;for(var d,e=c||0,f=b.length;(d=b[e])||f>e;e++)if(d==a)return e;return-1},enyo.remove=function(a,b){var c=enyo.indexOf(a,b);c>=0&&b.splice(c,1)},enyo.forEach=function(a,b,c){if(a){var d=c||this;if(enyo.isArray(a)&&a.forEach)a.forEach(b,d);else for(var e=Object(a),f=e.length>>>0,g=0;f>g;g++)g in e&&b.call(d,e[g],g,e)}},enyo.map=function(a,b,c){var d=c||this;if(enyo.isArray(a)&&a.map)return a.map(b,d);var e=[],f=function(a,c,f){e.push(b.call(d,a,c,f))};return enyo.forEach(a,f,d),e},enyo.filter=function(a,b,c){var d=c||this;if(enyo.isArray(a)&&a.filter)return a.filter(b,d);var e=[],f=function(a,c,f){var g=a;b.call(d,a,c,f)&&e.push(g)};return enyo.forEach(a,f,d),e},enyo.keys=Object.keys||function(a){var b=[],c=Object.prototype.hasOwnProperty;for(var d in a)c.call(a,d)&&b.push(d);if(!{toString:null}.propertyIsEnumerable("toString"))for(var e,f=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],g=0;e=f[g];g++)c.call(a,e)&&b.push(e);return b},enyo.cloneArray=function(a,b,c){for(var d=c||[],e=b||0,f=a.length;f>e;e++)d.push(a[e]);return d},enyo.toArray=enyo.cloneArray,enyo.clone=function(a){return enyo.isArray(a)?enyo.cloneArray(a):enyo.mixin({},a)};var b={};enyo.mixin=function(a,c){if(a=a||{},c){var d,e;for(d in c)e=c[d],b[d]!==e&&(a[d]=e)}return a},enyo.bind=function(a,b){if(b||(b=a,a=null),a=a||enyo.global,enyo.isString(b)){if(!a[b])throw'enyo.bind: scope["'+b+'"] is null (scope="'+a+'")';b=a[b]}if(enyo.isFunction(b)){var c=enyo.cloneArray(arguments,2);return b.bind?b.bind.apply(b,[a].concat(c)):function(){var d=enyo.cloneArray(arguments);return b.apply(a,c.concat(d))}}throw'enyo.bind: scope["'+b+'"] is not a function (scope="'+a+'")'},enyo.asyncMethod=function(){return setTimeout(enyo.bind.apply(enyo,arguments),1)},enyo.call=function(a,b,c){var d=a||this;if(b){var e=d[b]||b;if(e&&e.apply)return e.apply(d,c||[])}},enyo.now=Date.now||function(){return(new Date).getTime()},enyo.nop=function(){},enyo.nob={},enyo.nar=[],enyo.instance=function(){},enyo.setPrototype||(enyo.setPrototype=function(a,b){a.prototype=b}),enyo.delegate=function(a){return enyo.setPrototype(enyo.instance,a),new enyo.instance},$L=function(a){return a}}(),enyo.job=function(a,b,c){enyo.job.stop(a),enyo.job._jobs[a]=setTimeout(function(){enyo.job.stop(a),b()},c)},enyo.job.stop=function(a){enyo.job._jobs[a]&&(clearTimeout(enyo.job._jobs[a]),delete enyo.job._jobs[a])},enyo.job._jobs={},enyo.macroize=function(a,b,c){var d,e,f=a,g=c||enyo.macroize.pattern,h=function(a,c){return d=enyo.getObject(c,!1,b),void 0===d||null===d?"{$"+c+"}":(e=!0,d)},i=0;do if(e=!1,f=f.replace(g,h),++i>=20)throw"enyo.macroize: recursion too deep";while(e);return f},enyo.quickMacroize=function(a,b,c){var d,e=a,f=c||enyo.macroize.pattern,g=function(a,c){return d=c in b?b[c]:enyo.getObject(c,!1,b),void 0===d||null===d?"{$"+c+"}":d};return e=e.replace(f,g)},enyo.macroize.pattern=/\{\$([^{}]*)\}/g,enyo.kind=function(a){enyo._kindCtors={};var b=a.name||"";delete a.name;var c="kind"in a,d=a.kind;delete a.kind;var e=enyo.constructorForKind(d),f=e&&e.prototype||null;if(c&&void 0===d||void 0===e){var g=void 0===d?"undefined kind":"unknown kind ("+d+")";throw"enyo.kind: Attempt to subclass an "+g+". Check dependencies for ["+(b||"<unnamed>")+"]."}var h=enyo.kind.makeCtor();return a.hasOwnProperty("constructor")&&(a._constructor=a.constructor,delete a.constructor),enyo.setPrototype(h,f?enyo.delegate(f):{}),enyo.mixin(h.prototype,a),h.prototype.kindName=b,h.prototype.base=e,h.prototype.ctor=h,enyo.forEach(enyo.kind.features,function(b){b(h,a)}),enyo.setObject(b,h),h},enyo.singleton=function(a,b){var c=a.name;delete a.name;var d=enyo.kind(a);enyo.setObject(c,new d,b)},enyo.kind.makeCtor=function(){return function(){if(!(this instanceof arguments.callee))throw"enyo.kind: constructor called directly, not using 'new'";var a;return this._constructor&&(a=this._constructor.apply(this,arguments)),this.constructed&&this.constructed.apply(this,arguments),a?a:void 0}},enyo.kind.defaultNamespace="enyo",enyo.kind.features=[],enyo.kind.features.push(function(a,b){var c=a.prototype;if(c.inherited||(c.inherited=enyo.kind.inherited),c.base)for(var d in b){var e=b[d];enyo.isFunction(e)&&(e._inherited=c.base.prototype[d]||enyo.nop,e.nom=c.kindName+"."+d+"()")}}),enyo.kind.inherited=function(a,b){return a.callee._inherited.apply(this,b||a)},enyo.kind.features.push(function(a,b){enyo.mixin(a,enyo.kind.statics),b.statics&&(enyo.mixin(a,b.statics),delete a.prototype.statics);for(var c=a.prototype.base;c;)c.subclass(a,b),c=c.prototype.base}),enyo.kind.statics={subclass:function(){},extend:function(a){enyo.mixin(this.prototype,a);var b=this;enyo.forEach(enyo.kind.features,function(c){c(b,a)})}},enyo._kindCtors={},enyo.constructorForKind=function(a){if(null===a||enyo.isFunction(a))return a;if(a){var b=enyo._kindCtors[a];return b?b:enyo._kindCtors[a]=enyo.Theme[a]||enyo[a]||enyo.getObject(a,!1,enyo)||window[a]||enyo.getObject(a)}return enyo.defaultCtor},enyo.Theme={},enyo.registerTheme=function(a){enyo.mixin(enyo.Theme,a)},enyo.kind({name:"enyo.Object",kind:null,constructor:function(){enyo._objectCount++},setPropertyValue:function(a,b,c){if(this[c]){var d=this[a];this[a]=b,this[c](d)}else this[a]=b},_setProperty:function(a,b,c){this.setPropertyValue(a,b,this.getProperty(a)!==b&&c)},destroyObject:function(a){this[a]&&this[a].destroy&&this[a].destroy(),this[a]=null},getProperty:function(a){var b="get"+enyo.cap(a);return this[b]?this[b]():this[a]},setProperty:function(a,b){var c="set"+enyo.cap(a);this[c]?this[c](b):this._setProperty(a,b,a+"Changed")},log:function(){var a=arguments.callee.caller,b=((a?a.nom:"")||"(instance method)")+":";enyo.logging.log("log",[b].concat(enyo.cloneArray(arguments)))},warn:function(){this._log("warn",arguments)},error:function(){this._log("error",arguments)},_log:function(a,b){if(enyo.logging.shouldLog(a))try{throw Error()}catch(c){enyo.logging._log(a,[b.callee.caller.nom+": "].concat(enyo.cloneArray(b))),enyo.log(c.stack)}}}),enyo._objectCount=0,enyo.Object.subclass=function(a,b){this.publish(a,b)},enyo.Object.publish=function(a,b){var c=b.published;if(c){var d=a.prototype;for(var e in c)enyo.Object.addGetterSetter(e,c[e],d)}},enyo.Object.addGetterSetter=function(a,b,c){var d=a;c[d]=b;var e=enyo.cap(d),f="get"+e;c[f]||(c[f]=function(){return this[d]});var g="set"+e,h=d+"Changed";c[g]||(c[g]=function(a){this._setProperty(d,a,h)})},enyo.kind({name:"enyo.Async",kind:enyo.Object,published:{timeout:0},failed:!1,context:null,constructor:function(){this.responders=[],this.errorHandlers=[]},accumulate:function(a,b){var c=b.length<2?b[0]:enyo.bind(b[0],b[1]);a.push(c)},response:function(){return this.accumulate(this.responders,arguments),this},error:function(){return this.accumulate(this.errorHandlers,arguments),this},route:function(a,b){var c=enyo.bind(this,"respond");a.response(function(a,b){c(b)});var d=enyo.bind(this,"fail");a.error(function(a,b){d(b)}),a.go(b)},handle:function(a,b){var c=b.shift();if(c)if(c instanceof enyo.Async)this.route(c,a);else{var d=enyo.call(this.context||this,c,[this,a]);d=void 0!==d?d:a,(this.failed?this.fail:this.respond).call(this,d)}},startTimer:function(){this.startTime=enyo.now(),this.timeout&&(this.timeoutJob=setTimeout(enyo.bind(this,"timeoutComplete"),this.timeout))},endTimer:function(){this.timeoutJob&&(this.endTime=enyo.now(),clearTimeout(this.timeoutJob),this.timeoutJob=null,this.latency=this.endTime-this.startTime)},timeoutComplete:function(){this.timedout=!0,this.fail("timeout")},respond:function(a){this.failed=!1,this.endTimer(),this.handle(a,this.responders)},fail:function(a){this.failed=!0,this.endTimer(),this.handle(a,this.errorHandlers)},recover:function(){this.failed=!1},go:function(a){return enyo.asyncMethod(this,function(){this.respond(a)}),this}}),enyo.xhr={request:function(a){var b=this.getXMLHttpRequest(a),c=enyo.path.rewrite(this.simplifyFileURL(a.url)),d=a.method||"GET",e=!a.sync;if(Math.random(),a.username?b.open(d,c,e,a.username,a.password):b.open(d,c,e),enyo.mixin(b,a.xhrFields),a.callback&&this.makeReadyStateHandler(b,a.callback),a.headers=a.headers||{},"GET"!==d&&enyo.platform.ios&&enyo.platform.ios>=6&&null!==a.headers["cache-control"]&&(a.headers["cache-control"]=a.headers["cache-control"]||"no-cache"),b.setRequestHeader)for(var f in a.headers)a.headers[f]&&b.setRequestHeader(f,a.headers[f]);return"function"==typeof b.overrideMimeType&&a.mimeType&&b.overrideMimeType(a.mimeType),b.send(a.body||null),!e&&a.callback&&b.onreadystatechange(b),b},cancel:function(a){a.onload&&(a.onload=null),a.onreadystatechange&&(a.onreadystatechange=null),a.abort&&a.abort()},makeReadyStateHandler:function(a,b){window.XDomainRequest&&a instanceof XDomainRequest&&(a.onload=function(){var c;"string"==typeof a.responseText&&(c=a.responseText),b.apply(null,[c,a])}),a.onreadystatechange=function(){if(4==a.readyState){var c;"string"==typeof a.responseText&&(c=a.responseText),b.apply(null,[c,a])}}},inOrigin:function(a){var b=document.createElement("a"),c=!1;return b.href=a,(":"===b.protocol||b.protocol===window.location.protocol&&b.hostname===window.location.hostname&&b.port===(window.location.port||("https:"===window.location.protocol?"443":"80")))&&(c=!0),c},simplifyFileURL:function(a){var b=document.createElement("a");return b.href=a,"file:"===b.protocol||":"===b.protocol&&"file:"===window.location.protocol?b.protocol+"//"+b.host+b.pathname:":"===b.protocol&&"x-wmapp0:"===window.location.protocol?window.location.protocol+"//"+window.location.pathname.split("/")[0]+"/"+b.host+b.pathname:a},getXMLHttpRequest:function(a){try{if(enyo.platform.ie<10&&window.XDomainRequest&&!a.headers&&!this.inOrigin(a.url)&&!/^file:\/\//.test(window.location.href))return new XDomainRequest}catch(b){}try{return new XMLHttpRequest}catch(b){}return null}},function(a){function b(){this.fake=!0,this._fields=[],this.boundary="--------------------------";for(var a=0;24>a;a++)this.boundary+=Math.floor(10*Math.random()).toString(16)}function c(a,b){if(this.name=b.name,this.type=b.type||"application/octet-stream",!enyo.isArray(a))throw Error("enyo.Blob only handles Arrays of Strings");if(a.length>0&&"string"!=typeof a[0])throw Error("enyo.Blob only handles Arrays of Strings");this._bufs=a}if(a.FormData)try{return new a.FormData,new a.Blob,enyo.FormData=a.FormData,enyo.Blob=a.Blob,void 0}catch(d){}b.prototype.getContentType=function(){return"multipart/form-data; boundary="+this.boundary},b.prototype.append=function(a,b,c){this._fields.push([a,b,c])},b.prototype.toString=function(){var a=this.boundary,b="";return enyo.forEach(this._fields,function(c){if(b+="--"+a+"\r\n",c[2]||c[1].name){var d=c[1],e=c[2]||d.name;b+='Content-Disposition: form-data; name="'+c[0]+'"; filename="'+e+'"\r\n',b+="Content-Type: "+d.type+"\r\n\r\n",b+=d.getAsBinary()+"\r\n"}else b+='Content-Disposition: form-data; name="'+c[0]+'";\r\n\r\n',b+=c[1]+"\r\n"}),b+="--"+a+"--"},enyo.FormData=b,c.prototype.getAsBinary=function(){var a="",b=a.concat.apply(a,this._bufs);return b},enyo.Blob=c}(window),enyo.AjaxProperties={cacheBust:!0,url:"",method:"GET",handleAs:"json",contentType:"application/x-www-form-urlencoded",sync:!1,headers:null,postBody:"",username:"",password:"",xhrFields:null,mimeType:null},enyo.kind({name:"enyo.Ajax",kind:enyo.Async,published:enyo.AjaxProperties,constructor:function(a){enyo.mixin(this,a),this.inherited(arguments)},go:function(a){return this.startTimer(),this.request(a),this},request:function(a){var b=this.url.split("?"),c=b.shift()||"",d=b.length?b.join("?").split("&"):[],e=null;enyo.isString(a)?e=a:a&&(e=enyo.Ajax.objectToQuery(a)),e&&(d.push(e),e=null),this.cacheBust&&d.push(Math.random());var f,g=d.length?[c,d.join("&")].join("?"):c,h={};"GET"!=this.method&&(f=this.postBody,"POST"===this.method&&f instanceof enyo.FormData?f.fake&&(h["Content-Type"]=f.getContentType(),f=""+f):(h["Content-Type"]=this.contentType,f instanceof Object&&(f="application/json"===this.contentType?JSON.stringify(f):"application/x-www-form-urlencoded"===this.contentType?enyo.Ajax.objectToQuery(f):""+f))),enyo.mixin(h,this.headers),0===enyo.keys(h).length&&(h=void 0);try{this.xhr=enyo.xhr.request({url:g,method:this.method,callback:enyo.bind(this,"receive"),body:f,headers:h,sync:window.PalmSystem?!1:this.sync,username:this.username,password:this.password,xhrFields:this.xhrFields,mimeType:this.mimeType})}catch(i){this.fail(i)}},receive:function(a,b){if(!this.failed&&!this.destroyed){var c;c="string"==typeof b.responseText?b.responseText:b.responseBody,this.xhrResponse={status:b.status,headers:enyo.Ajax.parseResponseHeaders(b),body:c},this.isFailure(b)?this.fail(b.status):this.respond(this.xhrToResponse(b))}},fail:function(){this.xhr&&(enyo.xhr.cancel(this.xhr),this.xhr=null),this.inherited(arguments)},xhrToResponse:function(a){return a?this[(this.handleAs||"text")+"Handler"](a):void 0},isFailure:function(a){try{var b="";return"string"==typeof a.responseText&&(b=a.responseText),0===a.status&&""===b?!0:0!==a.status&&(a.status<200||a.status>=300)}catch(c){return!0}},xmlHandler:function(a){return a.responseXML},textHandler:function(a){return a.responseText},jsonHandler:function(a){var b=a.responseText;try{return b&&enyo.json.parse(b)}catch(c){return enyo.warn("Ajax request set to handleAs JSON but data was not in JSON format"),b}},statics:{objectToQuery:function(a){var b=encodeURIComponent,c=[],d={};for(var e in a){var f=a[e];if(f!=d[e]){var g=b(e)+"=";if(enyo.isArray(f))for(var h=0;h<f.length;h++)c.push(g+b(f[h]));else c.push(g+b(f))}}return c.join("&")},parseResponseHeaders:function(a){var b={},c=[];a.getAllResponseHeaders&&(c=a.getAllResponseHeaders().split(/\r?\n/));for(var d=0;d<c.length;d++){var e=c[d],f=e.indexOf(": ");if(f>0){var g=e.substring(0,f).toLowerCase(),h=e.substring(f+2);b[g]=h}}return b}}}),enyo.kind({name:"enyo.JsonpRequest",kind:enyo.Async,published:{url:"",charset:null,callbackName:"callback",cacheBust:!0},statics:{nextCallbackID:0},addScriptElement:function(){var a=document.createElement("script");a.src=this.src,a.async="async",this.charset&&(a.charset=this.charset),a.onerror=enyo.bind(this,function(){this.fail(400)});var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b),this.scriptTag=a},removeScriptElement:function(){var a=this.scriptTag;this.scriptTag=null,a.onerror=null,a.parentNode&&a.parentNode.removeChild(a)},constructor:function(a){enyo.mixin(this,a),this.inherited(arguments)},go:function(a){return this.startTimer(),this.jsonp(a),this},jsonp:function(a){var b="enyo_jsonp_callback_"+enyo.JsonpRequest.nextCallbackID++;this.src=this.buildUrl(a,b),this.addScriptElement(),window[b]=enyo.bind(this,this.respond);var c=enyo.bind(this,function(){this.removeScriptElement(),window[b]=null});this.response(c),this.error(c)},buildUrl:function(a,b){var c=this.url.split("?"),d=c.shift()||"",e=c.join("?").split("&"),f=this.bodyArgsFromParams(a,b);return e.push(f),this.cacheBust&&e.push(Math.random()),[d,e.join("&")].join("?")},bodyArgsFromParams:function(a,b){if(enyo.isString(a))return a.replace("=?","="+b);var c=enyo.mixin({},a);return c[this.callbackName]=b,enyo.Ajax.objectToQuery(c)}}),function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Math.uuid=function(b,c){var d=a,e=[];if(c=c||d.length,b)for(var f=0;b>f;f++)e[f]=d[0|Math.random()*c];else{var g;e[8]=e[13]=e[18]=e[23]="-",e[14]="4";for(var f=0;36>f;f++)e[f]||(g=0|16*Math.random(),e[f]=d[19==f?8|3&g:g])}return e.join("")},Math.uuidFast=function(){for(var b,c=a,d=Array(36),e=0,f=0;36>f;f++)8==f||13==f||18==f||23==f?d[f]="-":14==f?d[f]="4":(2>=e&&(e=0|33554432+16777216*Math.random()),b=15&e,e>>=4,d[f]=c[19==f?8|3&b:b]);return d.join("")},Math.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random(),c="x"==a?b:8|3&b;return c.toString(16)}).toUpperCase()}}();var Crypto={};!function(){Crypto.MD5=function(a){function b(a,b){return a<<b|a>>>32-b}function c(a,b){var c,d,e,f,g;return e=2147483648&a,f=2147483648&b,c=1073741824&a,d=1073741824&b,g=(1073741823&a)+(1073741823&b),c&d?2147483648^g^e^f:c|d?1073741824&g?3221225472^g^e^f:1073741824^g^e^f:g^e^f}function d(a,b,c){return a&b|~a&c}function e(a,b,c){return a&c|b&~c}function f(a,b,c){return a^b^c}function g(a,b,c){return b^(a|~c)}function h(a,e,f,g,h,i,j){return a=c(a,c(c(d(e,f,g),h),j)),c(b(a,i),e)}function i(a,d,f,g,h,i,j){return a=c(a,c(c(e(d,f,g),h),j)),c(b(a,i),d)}function j(a,d,e,g,h,i,j){return a=c(a,c(c(f(d,e,g),h),j)),c(b(a,i),d)}function k(a,d,e,f,h,i,j){return a=c(a,c(c(g(d,e,f),h),j)),c(b(a,i),d)}function l(a){for(var b,c=a.length,d=c+8,e=(d-d%64)/64,f=16*(e+1),g=Array(f-1),h=0,i=0;c>i;)b=(i-i%4)/4,h=8*(i%4),g[b]=g[b]|a.charCodeAt(i)<<h,i++;return b=(i-i%4)/4,h=8*(i%4),g[b]=g[b]|128<<h,g[f-2]=c<<3,g[f-1]=c>>>29,g}function m(a){var b,c,d="",e="";for(c=0;3>=c;c++)b=255&a>>>8*c,e="0"+b.toString(16),d+=e.substr(e.length-2,2);return d}var n,o,p,q,r,s,t,u,v,w=[],x=7,y=12,z=17,A=22,B=5,C=9,D=14,E=20,F=4,G=11,H=16,I=23,J=6,K=10,L=15,M=21;for(w=l(a),s=1732584193,t=4023233417,u=2562383102,v=271733878,n=0;n<w.length;n+=16)o=s,p=t,q=u,r=v,s=h(s,t,u,v,w[n+0],x,3614090360),v=h(v,s,t,u,w[n+1],y,3905402710),u=h(u,v,s,t,w[n+2],z,606105819),t=h(t,u,v,s,w[n+3],A,3250441966),s=h(s,t,u,v,w[n+4],x,4118548399),v=h(v,s,t,u,w[n+5],y,1200080426),u=h(u,v,s,t,w[n+6],z,2821735955),t=h(t,u,v,s,w[n+7],A,4249261313),s=h(s,t,u,v,w[n+8],x,1770035416),v=h(v,s,t,u,w[n+9],y,2336552879),u=h(u,v,s,t,w[n+10],z,4294925233),t=h(t,u,v,s,w[n+11],A,2304563134),s=h(s,t,u,v,w[n+12],x,1804603682),v=h(v,s,t,u,w[n+13],y,4254626195),u=h(u,v,s,t,w[n+14],z,2792965006),t=h(t,u,v,s,w[n+15],A,1236535329),s=i(s,t,u,v,w[n+1],B,4129170786),v=i(v,s,t,u,w[n+6],C,3225465664),u=i(u,v,s,t,w[n+11],D,643717713),t=i(t,u,v,s,w[n+0],E,3921069994),s=i(s,t,u,v,w[n+5],B,3593408605),v=i(v,s,t,u,w[n+10],C,38016083),u=i(u,v,s,t,w[n+15],D,3634488961),t=i(t,u,v,s,w[n+4],E,3889429448),s=i(s,t,u,v,w[n+9],B,568446438),v=i(v,s,t,u,w[n+14],C,3275163606),u=i(u,v,s,t,w[n+3],D,4107603335),t=i(t,u,v,s,w[n+8],E,1163531501),s=i(s,t,u,v,w[n+13],B,2850285829),v=i(v,s,t,u,w[n+2],C,4243563512),u=i(u,v,s,t,w[n+7],D,1735328473),t=i(t,u,v,s,w[n+12],E,2368359562),s=j(s,t,u,v,w[n+5],F,4294588738),v=j(v,s,t,u,w[n+8],G,2272392833),u=j(u,v,s,t,w[n+11],H,1839030562),t=j(t,u,v,s,w[n+14],I,4259657740),s=j(s,t,u,v,w[n+1],F,2763975236),v=j(v,s,t,u,w[n+4],G,1272893353),u=j(u,v,s,t,w[n+7],H,4139469664),t=j(t,u,v,s,w[n+10],I,3200236656),s=j(s,t,u,v,w[n+13],F,681279174),v=j(v,s,t,u,w[n+0],G,3936430074),u=j(u,v,s,t,w[n+3],H,3572445317),t=j(t,u,v,s,w[n+6],I,76029189),s=j(s,t,u,v,w[n+9],F,3654602809),v=j(v,s,t,u,w[n+12],G,3873151461),u=j(u,v,s,t,w[n+15],H,530742520),t=j(t,u,v,s,w[n+2],I,3299628645),s=k(s,t,u,v,w[n+0],J,4096336452),v=k(v,s,t,u,w[n+7],K,1126891415),u=k(u,v,s,t,w[n+14],L,2878612391),t=k(t,u,v,s,w[n+5],M,4237533241),s=k(s,t,u,v,w[n+12],J,1700485571),v=k(v,s,t,u,w[n+3],K,2399980690),u=k(u,v,s,t,w[n+10],L,4293915773),t=k(t,u,v,s,w[n+1],M,2240044497),s=k(s,t,u,v,w[n+8],J,1873313359),v=k(v,s,t,u,w[n+15],K,4264355552),u=k(u,v,s,t,w[n+6],L,2734768916),t=k(t,u,v,s,w[n+13],M,1309151649),s=k(s,t,u,v,w[n+4],J,4149444226),v=k(v,s,t,u,w[n+11],K,3174756917),u=k(u,v,s,t,w[n+2],L,718787259),t=k(t,u,v,s,w[n+9],M,3951481745),s=c(s,o),t=c(t,p),u=c(u,q),v=c(v,r);var N=m(s)+m(t)+m(u)+m(v);return N.toLowerCase()}}();var hexcase=0,b64pad="=",chrsz=8;window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB,window.IDBCursor=window.IDBCursor||window.webkitIDBCursor,window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction,IDBTransaction=IDBTransaction||{},IDBTransaction.READ_WRITE=IDBTransaction.READ_WRITE||"readwrite",IDBTransaction.READ=IDBTransaction.READ||"readonly",IDBCursor=IDBCursor||{},IDBCursor.NEXT=IDBCursor.NEXT||"next",IDBCursor.PREV=IDBCursor.PREV||"prev",enyo.kind({name:"DataLayout",kind:null,constructor:function(a){this.container=a},destroy:function(){}}),enyo.kind({name:"SundayDataIDB",kind:"DataLayout",published:{database:"",dbcallback:{},needupgrade:!1},async:enyo.Async,DOC_STORE:"doc-store",CONFIG_STORE:"config-store",ATTACHMENT_STORE:"attachment-store",idb:!1,max_number:9007199254740992,viewfunctions:{},returnarray:{},returnend:{},returnattachments:{},commit:function(a,b){b.dispatchTarget},handleerror:function(a,b){0===a.responders.length?a.response(function(){return{ok:!1,error:{status:500,error:b.type,reason:b.target}}}):a.go({ok:!1,error:{status:500,error:b.type,reason:b.target}})},success:function(a){this.idb=a.target.result;var b=this.idb.transaction(this.DOC_STORE,window.IDBTransaction.READ),c=b.objectStore(this.DOC_STORE).openCursor();c.onsuccess=enyo.bind(this,this.viewresults),c.onerror=enyo.bind(this,this.handleerror)},viewresults:function(a){var b=a.target.result;if(b){var c={key:b.key,id:b.primaryKey,value:b.value},d=c.id.match(/^_design\/(.*)/);if(null!==d)for(var e in c.value.views)this.viewfunctions[d[1]+"_"+e]=c.value.views[e].map;b["continue"]()}else this.unrollpreque()},unrollpreque:function(){for(var a=this.preque,b=a.length,c=0;b>c;c++)"builkDocs"===a[c].type?this.bulkDocs(a[c].docs,a[c].async):"allDocs"===a[c].type?this.allDocs(a[c].options,a[c].async,a[c].config):"put"===a[c].type?this.put(a[c].doc,a[c].options,a[c].async,a[c].config):"putAttachment"===a[c].type?this.put(a[c].docid,a[c].rev,a[c].name,a[c].doc,a[c].async):"putupdate"===a[c].type?this.putupdate(a[c].async,a[c].doc,a[c].options,a[c].ev):"runview"===a[c].type?this.runview(a[c].view,a[c].funstring,a[c].docu):"get"===a[c].type?this.get(a[c].docid,a[c].async,a[c].config):"getAttachment"===a[c].type?this.get(a[c].docid,a[c].options,a[c].config):"remove"===a[c].type?this.remove(a[c].docid,a[c].localrev,a[c].async,a[c].config):"query"===a[c].type&&this.query(a[c].fun,a[c].options,a[c].async);this.preque.pop()},versioncomplete:function(){0===this.dbcallback.responders.length?this.dbcallback.response(function(){return{ok:!0}}):this.dbcallback.go({ok:!0})},versionsuccess:function(a,b){b.target.result.oncomplete=enyo.bind(this,this.versioncomplete),this.upgradeneeded(a)},upgradeneeded:function(a){var b=(a.target.result.createObjectStore(this.DOC_STORE,{keyPath:"_id"}),a.target.result.createObjectStore(this.CONFIG_STORE,{keyPath:"config"}),a.target.result.createObjectStore(this.ATTACHMENT_STORE),a.target.transaction.objectStore(this.DOC_STORE));b.createIndex("changes","_update_seq",{unique:!1})},constructor:function(a){this.inherited(arguments),this.preque=[],this.dbcallback=new enyo.Async,"string"==typeof a?a&&(this.database=a):void 0!==this.container.database&&(this.database=this.container.database);var b=indexedDB.open(this.database);b.onsuccess=enyo.bind(this,this.success),b.onerror=enyo.bind(this,this.handleerror,this.dbcallback),b.onupgradeneeded=enyo.bind(this,this.upgradeneeded),b.onblocked=function(){}},removeDB:function(a){this.idb.close();var b=enyo.global.indexedDB.deleteDatabase(this.database);return b.onsuccess=enyo.bind(this,this.removeDBsuccess,a),b.onerror=enyo.bind(this,this.handleerror,a),a},removeDBsuccess:function(a){0===a.responders.length?a.response(function(){return{ok:!0}}):a.go({ok:!0})},runview:function(view,funstring,docu,viewid,last){if(this.idb)if(void 0!==docu){if(void 0!==docu._id){var newdoc={},emit=function(a,b){newdoc["_view_"+view]=a,newdoc["_view_"+view+"_value"]=b},log=console.log;if(eval("var fun = "+funstring),fun(docu),"_view_"+view in newdoc||(newdoc["_view_"+view]=null,newdoc["_view_"+view+"_value"]=null),view===last){enyo.mixin(docu,newdoc);for(var viewdoc in this.returnarray[viewid])enyo.mixin(docu,this.returnarray[viewid][viewdoc]);async=new enyo.Async;var txn=this.idb.transaction(this.DOC_STORE,window.IDBTransaction.READ_WRITE),datastore=txn.objectStore(this.DOC_STORE).get(docu._id);datastore.onsuccess=enyo.bind(this,this.putupdate,async,docu,{update_seq:!0}),datastore.onerror=enyo.bind(this,this.handleerror,async)}else this.returnarray[viewid].push(newdoc)}}else{var async=new enyo.Async,parent=this;async.response(function(a,b){for(var c in b.rows){var d=b.rows[c].id.match(/^_design\/(.*)/),e=b.rows[c].id;null===d&&(void 0===parent.returnarray[viewid+"_"+e]&&(parent.returnarray[viewid+"_"+e]=[]),parent.runview(view,funstring,b.rows[c].doc,viewid+"_"+e,last))}}),this.allDocs({include_docs:!0},async)}else this.preque.push({type:"runview",view:view,funstring:funstring,docu:docu})},upgradeneededview:function(a,b){var c=b.currentTarget.transaction.objectStore(this.DOC_STORE);for(var d in a){var e=a[d].replace("/","_");c.indexNames.contains(e)===!1&&c.createIndex(e,"_view_"+e,{unique:!1})}},putview:function(a,b,c){this.idb=c.target.result;var d=this.idb.transaction(this.DOC_STORE,window.IDBTransaction.READ_WRITE),e=d.objectStore(this.DOC_STORE).get(a._id);e.onsuccess=enyo.bind(this,this.putupdate,b,a,{update_seq:!0}),e.onerror=enyo.bind(this,this.handleerror,b),this.unrollpreque()},put:function(a,b,c,d){if(void 0===c&&(c=new enyo.Async),b?b.update_seq:!1,this.idb){var e,f,g,h=null;if(d||(void 0===a._id&&(a._id=Math.uuid(32,16).toLowerCase()),void 0===a._localrev&&(a._localrev="1-"+Math.uuid(32,16).toLowerCase()),h=a._id.match(/_design\/(.*)/)),null===h){var i,j=this.DOC_STORE;if(d){j=this.CONFIG_STORE,i=this.idb.transaction(j,window.IDBTransaction.READ_WRITE);var k=i.objectStore(j).put(a);k.onsuccess=enyo.bind(this,this.putsuccess,c,""),k.onerror=enyo.bind(this,this.handleerror,c)}else{i=this.idb.transaction(j,window.IDBTransaction.READ_WRITE);var l=i.objectStore(j).get(a._id);l.onsuccess=enyo.bind(this,this.putupdate,c,a,b),l.onerror=enyo.bind(this,this.handleerror,c),e=[];for(var m in this.viewfunctions)e.push(m);if(0!==e.length){g="views"+Math.uuid(32,16).toLowerCase(),this.returnarray[g]=[],f=e[e.length-1];for(var n in this.viewfunctions)this.runview(n,this.viewfunctions[n],a,g,f)}}}else if(void 0!==a.views){var o=a._id.match(/^_design\/(.*)/),p=[];e=[];for(var q in a.views)e.push(q);f=o[1]+"_"+e[e.length-1],g="views"+Math.uuid(32,16).toLowerCase();for(var r in a.views){var s=o[1]+"_"+r;this.viewfunctions[s]=a.views[r].map,p.push(s),enyo.job(s,enyo.bind(this,"runview",s,a.views[r].map,void 0,g,f),50)}var t=this.idb.version;this.idb.close(),this.idb=!1;var u=indexedDB.open(this.database,t+1);u.onsuccess=enyo.bind(this,this.putview,a,c),u.onerror=enyo.bind(this,this.handleerror,this.dbcallback),u.onupgradeneeded=enyo.bind(this,this.upgradeneededview,p),u.onblocked=function(){}}}else this.preque.push({type:"put",doc:a,options:b,config:d,async:c});return c},putAttachment:function(a,b,c){if(void 0===c&&(c=new enyo.Async),this.idb){store=this.ATTACHMENT_STORE,txn=this.idb.transaction(store,window.IDBTransaction.READ_WRITE);var d=txn.objectStore(store).put(b,a);d.onsuccess=enyo.bind(this,this.putsuccess,c,""),d.onerror=enyo.bind(this,this.handleerror,c)}else this.preque.push({type:"putAttachment",docid:docd,rev:rev,name:name,doc:b,async:c});return c},putupdate:function(a,b,c,d){if(this.idb){var e=d.target.result,f=this.DOC_STORE,g=this.idb.transaction(f,window.IDBTransaction.READ_WRITE),h={},i=c?c.update_seq:!1;if(e){var j=e._deleted?!0:!1,k=void 0!==e._rev?e._rev[0]:0,l=void 0!==b._rev?b._rev[0]:0,m=l>k,n=/^_view_.*/;for(var o in e.doc)null!==o.match(n)&&void 0===b[o]&&(b[o]=e[o]);if(m||void 0!==e._localrev||j)if(m||j||e._localrev===b._localrev||parseInt(b._localrev[0],10)>parseInt(e._localrev[0],10)){if(!j&&!i){var p;p=m?parseInt(e._localrev[0],10)+1:parseInt(b._localrev[0],10)+1,b._localrev=p+"-"+Math.uuid(32,16).toLowerCase()}b._revhistory=e,i||(b._update_seq=this.max_number),h=g.objectStore(f).put(b),h.onsuccess=enyo.bind(this,this.putsuccess,a,b._localrev),h.onerror=enyo.bind(this,this.handleerror,a)}else 0===a.responders.length?a.response(function(){return{error:"conflict",reason:"Document update conflict."}}):a.go({error:"conflict",reason:"Document update conflict."})}else i||(b._update_seq=this.max_number),h=g.objectStore(f).put(b),h.onsuccess=enyo.bind(this,this.putsuccess,a,b._localrev),h.onerror=enyo.bind(this,this.handleerror,a)
}else this.preque.push({type:"putupdate",doc:b,options:c,ev:d,async:a})},putsuccess:function(a,b,c){var d=c.target.result;0===a.responders.length?a.response(function(){return{ok:!0,id:d,rev:b}}):a.go({ok:!0,id:d,rev:b})},bulkDocs:function(a,b,c){void 0===c&&(c=new enyo.Async);var d=b.update_seq?{update_seq:!0}:{};if(this.idb){var e="bulk"+Math.uuid(32,16).toLowerCase();this.returnarray[e]=[];for(var f=a.length,g=function(a,b){b.ok===!0?this.bulkDocsresults(c,f,e,{id:b.id,rev:b.rev}):this.bulkDocsresults(c,f,e,b)},h=function(a,b){b.ok===!0?this.bulkDocsresults(c,f,e,{id:b.id,rev:b.rev,_deleted:!0}):this.bulkDocsresults(c,f,e,b)},i=0;f>i;i++){var j=a[i];if(void 0===j._deleted){var k=this.put(j,d);k.response(this,g)}else{var l=this.remove(j._id,j._localrev);l.response(this,h)}}}else this.preque.push({type:"builkDocs",docs:a,async:c});return c},bulkDocsresults:function(a,b,c,d){if(this.returnarray[c].push(d),this.returnarray[c].length===b){var e=this.returnarray[c];delete this.returnarray[c],0===a.responders.length?a.response(this,function(){return e}):a.go(e)}},get:function(a,b,c){if(void 0===b&&(b=new enyo.Async),this.idb){var d=this.DOC_STORE;c&&(d=this.CONFIG_STORE);var e=this.idb.transaction(d,window.IDBTransaction.READ),f=e.objectStore(d).get(a);f.onsuccess=enyo.bind(this,this.getsuccess,b),f.onerror=enyo.bind(this,this.handleerror,b)}else this.preque.push({type:"get",docid:a,config:c,async:b});return b},getAttachment:function(a,b,c){if(void 0===c&&(c=new enyo.Async),this.idb){var d=this.ATTACHMENT_STORE,e=this.idb.transaction(d,window.IDBTransaction.READ),f=e.objectStore(d).get(a);f.onsuccess=enyo.bind(this,this.getsuccess,c),f.onerror=enyo.bind(this,this.handleerror,c)}else this.preque.push({type:"getAttachment",docid:a,options:b,async:c});return c},getsuccess:function(a,b){var c=b.target.result;if(void 0!==c){if(void 0!==c._revhistory){delete c._revhistory;var d=/^_view_.*/;for(var e in c)null!==e.match(d)&&delete c[e]}c._deleted?0===a.responders.length?a.response(function(){return{error:"Not Found",reason:"Deleted"}}):a.go({error:"Not Found",reason:"Deleted"}):0===a.responders.length?a.response(function(){return c}):a.go(c)}else 0===a.responders.length?a.response(function(){return{error:"Not Found"}}):a.go({error:"Not Found"})},allDocs:function(a,b,c){if(void 0===b&&(b=new enyo.Async),this.idb){var d="all"+Math.uuid(32,16).toLowerCase();this.returnarray[d]=[];var e=this.DOC_STORE;c&&(e=this.CONFIG_STORE);var f=this.idb.transaction(e,window.IDBTransaction.READ),g=f.objectStore(e).openCursor();g.onsuccess=enyo.bind(this,this.allDocssuccess,b,d,a),g.onerror=enyo.bind(this,this.handleerror,b)}else this.preque.push({type:"allDocs",options:a,config:c,async:b});return b},attachmentResponse:function(a,b,c,d,e,f,g,h){var i=new this.async;i.error(function(b,c){var d={error:"Unknown",reason:c};return a.recover(),d}),i.response(function(d,i){if(a.returnattachments[c].pop(),void 0!==g&&g.base64){var j=/^data:.+\/(.+);base64,(.*)$/,k=i.match(j);k.length>2&&(e.doc._attachments[f].data=k[2])}else e.doc._attachments[f].data=i;void 0!==g&&!g.include_docs&&delete e.doc,a.returnarray[c].push(e),0===a.returnattachments[c].length&&a.returnend[c]===!0&&h(b,c,{},{target:{result:!1}})}),this.getAttachment(d,{},i)},allDocssuccess:function(a,b,c,d){var e=d.target.result;if(e){var f={key:e.key,id:e.primaryKey,value:{rev:e.value._localrev},doc:e.value};if(void 0===f.doc._deleted){delete f.doc._revhistory;var g=/^_view_.*/;for(var h in f.doc)null!==h.match(g)&&delete f.doc[h];if(void 0!==c&&c.attachments){void 0===this.returnattachments[b]&&(this.returnattachments[b]=[]);for(var i in f.doc._attachments){this.returnattachments[b].push(i);var j=f.doc._attachments[i].data,k=this;this.attachmentResponse(k,a,b,j,f,i,c,enyo.bind(this,this.allDocssuccess))}}else void 0!==c&&!c.include_docs&&delete f.doc,this.returnarray[b].push(f)}e["continue"]()}else if(void 0!==c&&!c.attachments||void 0===this.returnattachments[b]||0===this.returnattachments[b].length){var l={total_rows:this.returnarray[b].length,rows:this.returnarray[b]};delete this.returnarray[b],0===a.responders.length?a.response(this,function(){return l}):a.go(l)}else this.returnend[b]=!0},changes:function(a,b){if(void 0===b&&(b=new enyo.Async),this.idb){var c="changes"+Math.uuid(32,16).toLowerCase();this.returnarray[c]=[];var d=this.idb.transaction(this.DOC_STORE,window.IDBTransaction.READ),e=d.objectStore(this.DOC_STORE),f=e.index("changes").openCursor();f.onsuccess=enyo.bind(this,this.changessuccess,b,c,a),f.onerror=enyo.bind(this,this.handleerror,b)}else this.preque.push({type:"query",fun:fun,options:a,async:b});return b},changessuccess:function(a,b,c,d){var e=d.target.result;if(e){if(null!==e.key&&e.value._update_seq===this.max_number){var f={id:e.primaryKey,changes:[{rev:e.value._localrev}],doc:e.value};delete f.doc._revhistory;var g=/^_view_.*/;for(var h in f.doc)null!==h.match(g)&&delete f.doc[h];if(void 0!==c&&c.attachments){void 0===this.returnattachments[b]&&(this.returnattachments[b]=[]);for(var i in f.doc._attachments){this.returnattachments[b].push(i);var j=f.doc._attachments[i].data,k=this;this.attachmentResponse(k,a,b,j,f,i,c,enyo.bind(this,this.changessuccess))}}else void 0!==c&&!c.include_docs&&delete f.doc,this.returnarray[b].push(f)}e["continue"]()}else if(void 0!==c&&!c.attachments||void 0===this.returnattachments[b]||0===this.returnattachments[b].length){var l={results:this.returnarray[b]};delete this.returnarray[b],0===a.responders.length?a.response(this,function(){return l}):a.go(l)}else this.returnend[b]=!0},query:function(a,b,c){if(void 0===c&&(c=new enyo.Async),this.idb){var d="query"+Math.uuid(32,16).toLowerCase();this.returnarray[d]=[];var e=this.idb.transaction(this.DOC_STORE,window.IDBTransaction.READ),f=e.objectStore(this.DOC_STORE);if(f.indexNames.contains(a.replace("/","_"))){var g=f.index(a.replace("/","_")).openCursor();g.onsuccess=enyo.bind(this,this.querysuccess,c,d,a),g.onerror=enyo.bind(this,this.handleerror,c)}else c.response(function(){return{ok:!1,error:{status:500,error:"query function does not excist",reason:a}}})}else this.preque.push({type:"query",fun:a,options:b,async:c});return c},querysuccess:function(a,b,c,d){var e=d.target.result;if(e){if(null!==e.key){var f={key:e.key,id:e.primaryKey,value:e.value["_view_"+c.replace("/","_")+"_value"],doc:e.value};if(f.doc&&void 0===f.doc._deleted){delete f.doc._revhistory;var g=/^_view_.*/;for(var h in f.doc)null!==h.match(g)&&delete f.doc[h];this.returnarray[b].push(f)}}e["continue"]()}else{var i={rows:this.returnarray[b]};delete this.returnarray[b],0===a.responders.length?a.response(this,function(){return i}):a.go(i)}},remove:function(a,b,c,d){if(void 0===c&&(c=new enyo.Async),this.idb){var e=this.DOC_STORE;d&&(e=this.CONFIG_STORE);var f=this.idb.transaction(e,window.IDBTransaction.READ_WRITE),g=f.objectStore(e).get(a);g.onsuccess=enyo.bind(this,this.removeget,c,b,d),g.onerror=enyo.bind(this,this.handleerror,c)}else this.preque.push({type:"remove",docid:a,localrev:b,config:d,async:c});return c},removeget:function(a,b,c,d){var e=d.target.result,f=this.DOC_STORE;if(c&&(f=this.CONFIG_STORE),e&&b===e._localrev){doc={_deleted:!0},doc._id=e._id,doc._localrev=e._localrev,doc._revhistory=e;var g=this.idb.transaction(f,window.IDBTransaction.READ_WRITE),h=g.objectStore(f).put(doc);h.onsuccess=enyo.bind(this,this.removesuccess,a,doc._id,doc._localrev),h.onerror=enyo.bind(this,this.handleerror,a)}},removesuccess:function(a,b,c){0===a.responders.length?a.response(function(){return{ok:!0,id:b,localrev:c}}):a.go({ok:!0,id:b,localrev:c})},replicate:function(a,b,c){var d=new a.async,e=new a.async,f=new this.async,g=this;d.response(function(a,b){var d=[],e=b.update_seq;void 0!==e&&g.put({config:"update_seq",value:e},void 0,void 0,!0);for(var f in b.rows)delete b.rows[f].doc._localrev,void 0!==e&&(b.rows[f].doc._update_seq=e),d.push(b.rows[f].doc);b.total_rows>0?g.bulkDocs(d,{update_seq:!0},c):c.go({})}),e.response(function(a,b){var d=[],e=b.last_seq;void 0!==e&&g.put({config:"update_seq",value:e},void 0,void 0,!0);for(var f in b.results)delete b.results[f].doc._localrev,void 0!==e&&(b.results[f].doc._update_seq=e),d.push(b.results[f].doc);d.length>0?g.bulkDocs(d,{update_seq:!0},c):c.go({})}),f.response(function(c,f){void 0!==f.value?a.changes(f.value,b,e):void 0!==b?(b.include_docs=!0,b.update_seq=!0,a.allDocs(b,d)):a.allDocs({include_docs:!0,update_seq:!0},d)}),this.get("update_seq",f,!0)}}),enyo.kind({name:"SundayDataHTTP",kind:"DataLayout",published:{database:"",host:"",dbcallback:{},username:"",password:""},async:enyo.Ajax,returnarray:{},authHeader:function(){var a="Basic "+binb2b64(str2binb(this.username+":"+this.password));return a},commit:function(a,b){b.dispatchTarget},handleerror:function(a,b){0===a.responders.length?a.response(function(){return{ok:!1,error:{status:500,error:b.type,reason:b.target}}}):a.go({ok:!1,error:{status:500,error:b.type,reason:b.target}})},constructor:function(){this.inherited(arguments),this.start()},start:function(a,b,c,d){void 0===a&&void 0===b&&void 0!==this.container&&(this.host=this.container.host,this.database=this.container.database,this.username=this.container.username,this.password=this.container.password),"string"==typeof b&&b&&(this.database=b),"string"==typeof a&&a&&(this.host=a),"string"==typeof c&&c&&(this.username=c),"string"==typeof d&&d&&(this.password=d),this.dbcallback=new enyo.Ajax({url:this.host+"/"+this.database+"/",method:"PUT",contentType:"application/json",cacheBust:!1}),""!==this.username&&""!==this.password&&(this.dbcallback.headers={Authorization:this.authHeader()}),this.dbcallback.go()},removeDB:function(a){return void 0===a&&(a=new enyo.Ajax),a.url=this.host+"/"+this.database+"/",a.cacheBust=!1,a.method="DELETE",""!==this.username&&""!==this.password&&(a.headers={Authorization:this.authHeader()}),a.go(),a},put:function(a,b,c){return void 0===c&&(c=new enyo.Ajax),c.contentType="application/json",c.cacheBust=!1,c.url=this.host+"/"+this.database+"/",c.method="POST",c.postBody=JSON.stringify(a),""!==this.username&&""!==this.password&&(c.headers={Authorization:this.authHeader()}),c.go(),c},bulkDocs:function(a,b,c){void 0===c&&(c=new enyo.Ajax),c.url=this.host+"/"+this.database+"/_bulk_docs",c.method="POST",c.contentType="application/json",c.cacheBust=!1;var d=enyo.mixin({docs:a},b);return c.postBody=JSON.stringify(d),""!==this.username&&""!==this.password&&(c.headers={Authorization:this.authHeader()}),c.go(),c},get:function(a,b){return void 0===b&&(b=new enyo.Ajax),b.url=this.host+"/"+this.database+"/"+a,b.method="GET",b.cacheBust=!1,""!==this.username&&""!==this.password&&(b.headers={Authorization:this.authHeader()}),b.go(),b},allDocs:function(a,b){return void 0===b&&(b=new enyo.Ajax),b.url=this.host+"/"+this.database+"/_all_docs",b.method="GET",b.contentType="application/json",b.cacheBust=!1,""!==this.username&&""!==this.password&&(b.headers={Authorization:this.authHeader()}),b.go(a),b},query:function(a,b,c){var d,e;if("string"==typeof a){var f=a.split("/");d=f[0],e=f[1]}return void 0===c&&(c=new enyo.Ajax),c.url=this.host+"/"+this.database+"/_design/"+d+"/_view/"+e,c.method="GET",c.contentType="application/json",c.cacheBust=!1,""!==this.username&&""!==this.password&&(c.headers={Authorization:this.authHeader()}),c.go(JSON.stringify(b)),c},remove:function(a,b,c){return void 0===c&&(c=new enyo.Ajax),c.url=this.host+"/"+this.database+"/"+a+"?rev="+b,c.method="DELETE",c.cacheBust=!1,""!==this.username&&""!==this.password&&(c.headers={Authorization:this.authHeader()}),c.go(),c},changes:function(a,b,c){void 0===a&&(a=0);var d="";if(void 0!==b)for(var e in b)d+="&"+e+"="+b[e];return void 0===c&&(c=new enyo.Ajax),c.url=this.host+"/"+this.database+"/_changes?include_docs=true&since="+a+d,c.method="GET",c.cacheBust=!1,""!==this.username&&""!==this.password&&(c.headers={Authorization:this.authHeader()}),c.go(),c},replicate:function(a,b,c){var d=new a.async,e=new this.async,f=this,g=[];e.response(function(b,d){if(g.length>0){var e=[];for(var f in d){var h=d[f],i=g[f];h.ok&&(i._rev=h.rev),e.push(i)}a.bulkDocs(g,{update_seq:!0},c)}else c.go(d)}),d.response(function(a,b){var d=[];for(var h in b.results){var i=b.results[h].doc;g.push(i),delete i._localrev,delete i._update_seq,d.push(i)}d.length>0?f.bulkDocs(d,{},e):c.go({})}),void 0!==b&&b.attachments?a.changes({include_docs:!0,attachments:!0,base64:!0},d):a.changes({include_docs:!0},d)}}),enyo.kind({name:"SundayData",kind:"enyo.Object",published:{dataStore:"",url:"",database:"",username:"",password:"",host:""},data:null,idbcheck:/idb\:\/\/([\w\-]+)\/?/,httpcheck:/((https?\:\/\/)?(\w*\:\w*@)?[\w\.]*\:?\d*)\/([\w\-]+)/,constructor:function(a){this.inherited(arguments),void 0!==a&&"string"==typeof a&&this.setUrl(a)},setUrl:function(a){if("string"==typeof a){var b=a.match(this.idbcheck);if(null!==b)""!==b[1]&&(this.setDatabase(b[1]),this.setDataStore("SundayDataIDB"));else{var c=a.match(this.httpcheck);if(null!==c&&""!==c[1]&&""!==c[4]){if(void 0!==c[3]){var d=c[3];d=d.replace(/@$/,"").split(":"),this.setUsername(d[0]),this.setPassword(d[1])}this.setHost(c[1].replace(c[3],"")),this.setDatabase(c[4]),this.setDataStore("SundayDataHTTP")}}}},dataStoreChanged:function(){this.data&&this.data.destroy(),this.data=enyo.createFromKind(this.dataStore,this),this.generated&&this.render()},removeDB:function(a){if(this.data){void 0===a&&(a=new this.data.async);var b=new SundayDataReturn;return b.parent=this,a.error(function(a,b){var c={error:"Unknown",reason:b};return this.recover(),c}),a.response(function(a,c){b.parent.data.destroy(),b.parent.dataStore="",b.parent.url="",b.parent.database="",b.parent.username="",b.parent.password="",b.parent.host="",b.setValue(c)}),this.data.removeDB(a),b}},put:function(a,b,c){if(this.data){void 0===c&&(c=new this.data.async);var d=new SundayDataReturn;return d.parent=this,c.error(function(a,b){var c={error:"Unknown",reason:b};return this.recover(),c}),c.response(function(a,b){d.setValue(b)}),this.data.put(a,b,c),d}},putAttachment:function(a,b,c){if(this.data){void 0===c&&(c=new this.data.async,getasync=new this.data.async);var d=new SundayDataReturn;d.parent=this;var e=this;return getasync.error(function(a,b){var c={error:"Unknown",reason:b};return this.recover(),c}),getasync.response(function(a,f){d.setValue(f);var g=f;void 0===g._attachments&&(g._attachments={});var h;b.name in g._attachments?h=g._attachments[b.name].data:(h=Math.uuid(32,16).toLowerCase(),g._attachments[b.name]={content_type:b.type,data:h});var i=new FileReader;i.onload=function(a){e.data.putAttachment(h,a.target.result,c)},i.readAsDataURL(b),e.data.put(g,{update_seq:!0},c)}),c.error(function(a,b){var c={error:"Unknown",reason:b};return this.recover(),c}),c.response(function(a,b){d.setValue(b)}),this.data.get(a,getasync),d}},get:function(a,b,c){if(this.data){void 0===c&&(c=new this.data.async);var d=new SundayDataReturn;return d.parent=this,c.error(function(a,b){var c={error:"Unknown",reason:b};return 404===b&&(c={error:"Not Found",reason:b}),this.recover(),c}),c.response(function(a,b){d.setValue(b)}),this.data.get(a,c),d}},getAttachment:function(a,b,c){if(this.data){void 0===c&&(c=new this.data.async);var d=new SundayDataReturn;return d.parent=this,c.error(function(a,b){var c={error:"Unknown",reason:b};return 404===b&&(c={error:"Not Found",reason:b}),this.recover(),c}),c.response(function(a,b){d.setValue(b)}),this.data.getAttachment(a,b,c),d}},allDocs:function(a,b){if(this.data){void 0===b&&(b=new this.data.async);var c=new SundayDataReturn;return c.parent=this,b.error(function(a,b){var c={error:"Unknown",reason:b};return this.recover(),c}),b.response(function(a,b){c.setValue(b)}),this.data.allDocs(a,b),c}},bulkDocs:function(a,b,c){if(this.data){void 0===c&&(c=new this.data.async);var d=new SundayDataReturn;return d.parent=this,c.error(function(a,b){var c={error:"Unknown",reason:b};return this.recover(),c}),c.response(function(a,b){d.setValue(b)}),this.data.bulkDocs(a,b,c),d}},remove:function(a,b,c){if(this.data){void 0===c&&(c=new this.data.async);var d=new SundayDataReturn;return d.parent=this,c.error(function(a,b){var c={error:"Unknown",reason:b};return 404===b?c={error:"Not Found",reason:b}:409===b&&(c={error:"Conflict",reason:b}),this.recover(),c}),c.response(function(a,b){d.setValue(b)}),this.data.remove(a,b,c),d}},query:function(a,b,c){if(this.data){void 0===c&&(c=new this.data.async);var d=new SundayDataReturn;return d.parent=this,c.error(function(a,b){var c={error:"Unknown",reason:b};return this.recover(),c}),c.response(function(a,b){d.setValue(b)}),this.data.query(a,b,c),d}},replicate:function(a,b,c){if(this.data){void 0===c&&(c=new this.data.async);var d=new SundayDataReturn;d.parent=this,c.error(function(a,b){var c={error:"Unknown",reason:b};return this.recover(),c}),c.response(function(a,b){d.setValue(b)});var e,f={},g=new enyo.Async;if("object"!=typeof a){var h=a.match(this.idbcheck);if(null!==h)""!==h[1]&&(f.database=h[1],f.dataStore="SundayDataIDB");else{var i=a.match(this.httpcheck);if(null!==i&&""!==i[1]&&""!==i[4]&&(f.dataStore="SundayDataHTTP",f.host=i[1].replace(i[3],""),f.database=i[4],void 0!==i[3])){var j=i[3];j=j.replace(/@$/,"").split(":"),f.username=j[0],f.password=j[1]}}e=enyo.createFromKind(f.dataStore,f)}else e=a.data;var k=this.data;return"SundayDataIDB"===this.dataStore?(g.response(function(){e.replicate(k,b,c)}),k.replicate(e,b,g)):(g.response(function(){k.replicate(e,b,c)}),e.replicate(k,b,g)),d}}}),enyo.createFromKind=function(a,b){var c=a&&enyo.constructorForKind(a);return c?new c(b):void 0};var SundayDataReturn=function(){this.resultStack=[],this.value=null,this.parent=null,this.setValue=function(a){this.value=a,this._results(a)},this.done=function(a){if(void 0===a&&(a=function(a){return console.log("value:",JSON.stringify(a)),a}),null===this.value)this.resultStack.push(a);else{var b=a(this.value);void 0!==b?this.setValue(b):this.setValue(this.value)}return this},this._results=function(a){if(this.resultStack.length>0){var b=this.resultStack.shift(),c=b(a);null!==c&&(void 0!==c?this.setValue(c):this.setValue(this.value))}},this.get=function(a,b){var c=this;if(null!==this.value&&0===this.resultStack.length)return void 0===a&&(a=void 0===this.value.id?this.value._id:this.value.id),void 0!==a?(this.parent.get(this.value,b).done(function(a){c.setValue(a)}),null):this;var d=function(b){if(void 0!==b||void 0!==a){var d;d=void 0===a?void 0===b.id?b._id:b.id:a,void 0!==d?c.parent.get(d).done(function(a){c.setValue(a)}):c.setValue(b)}return null};return this.resultStack.push(d),this},this.put=function(a,b){var c=this;if(null!==this.value&&0===this.resultStack.length)return void 0===a&&(this.value=a),id=void 0===this.value.id?this.value._id:this.value.id,void 0!==id?(this.parent.put(this.value,b).done(function(a){c.setValue(a)}),null):this;var d=function(d){if(void 0!==a&&(d=a),void 0!==d){var e=void 0===d.id?d._id:d.id;void 0!==e?c.parent.put(d,b).done(function(a){c.setValue(a)}):c.setValue(d)}return null};return this.resultStack.push(d),this},this.removeDB=function(){var a=this,b=function(b){return void 0!==b?(a.parent.removeDB().done(function(b){a.setValue(b)}),null):void 0};return this.resultStack.push(b),this},this.bulkDocs=function(a,b){if(void 0===a){var c=this,d=function(a){return void 0!==a&&a instanceof Array?c.parent.bulkDocs(a,b).done(function(a){c.setValue(a)}):c.setValue(a),null};return this.resultStack.push(d),this}return this.parent.bulkDocs(a,b)},this.allDocs=function(a){var b=this,c=function(){return b.parent.allDocs(a).done(function(a){b.setValue(a)}),null};return this.resultStack.push(c),this},this.remove=function(a,b){if(void 0===a){if(null!==this.value)return a=void 0===this.value.id?this.value._id:this.value.id,b=void 0===this.value.rev?this.value._rev:this.value.rev,void 0!==a?this.parent.remove(a,b):this;var c=this,d=function(a){if(void 0!==a){var b=void 0===a.id?a._id:a.id,d=void 0===a.rev?a._rev:a.rev;void 0!==b?c.parent.remove(b,d).done(function(a){c.setValue(a)}):c.setValue(a)}return null};return this.resultStack.push(d),this}return this.parent.remove(a,b)},this.query=function(a,b){var c=this,d=function(){return c.parent.query(a,b).done(function(a){c.setValue(a)}),null};return this.resultStack.push(d),this},this.replicate=function(a){var b=this,c=function(){return b.parent.replicate(a).done(function(a){b.setValue(a)}),null};return this.resultStack.push(c),this}};global.SundayData=SundayData}({},function(){return this}());